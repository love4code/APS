<%- include('../partials/header', { title: 'Company Settings' }) %>

<div class="container-fluid">
  <div class="row">
    <div class="col-md-10 mx-auto">
      <h1 class="h3 mb-4">Company Settings</h1>
      <p class="text-muted mb-4">Update your company information that will appear on invoices and other documents.</p>

      <form method="POST" action="/settings" enctype="multipart/form-data">
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="mb-0">Company Information</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-12 mb-3">
                <label for="companyName" class="form-label">Company Name *</label>
                <input type="text" class="form-control" id="companyName" name="companyName" value="<%= settings.companyName || '' %>" required>
              </div>
            </div>

            <div class="row">
              <div class="col-md-12 mb-3">
                <label for="companyAddress" class="form-label">Address</label>
                <input type="text" class="form-control" id="companyAddress" name="companyAddress" value="<%= settings.companyAddress || '' %>">
              </div>
            </div>

            <div class="row">
              <div class="col-md-4 mb-3">
                <label for="companyCity" class="form-label">City</label>
                <input type="text" class="form-control" id="companyCity" name="companyCity" value="<%= settings.companyCity || '' %>">
              </div>
              <div class="col-md-4 mb-3">
                <label for="companyState" class="form-label">State</label>
                <input type="text" class="form-control" id="companyState" name="companyState" value="<%= settings.companyState || '' %>">
              </div>
              <div class="col-md-4 mb-3">
                <label for="companyZipCode" class="form-label">Zip Code</label>
                <input type="text" class="form-control" id="companyZipCode" name="companyZipCode" value="<%= settings.companyZipCode || '' %>">
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="companyPhone" class="form-label">Phone</label>
                <input type="tel" class="form-control" id="companyPhone" name="companyPhone" value="<%= settings.companyPhone || '' %>">
              </div>
              <div class="col-md-6 mb-3">
                <label for="companyEmail" class="form-label">Email</label>
                <input type="email" class="form-control" id="companyEmail" name="companyEmail" value="<%= settings.companyEmail || '' %>">
              </div>
            </div>

            <div class="row">
              <div class="col-md-12 mb-3">
                <label for="companyWebsite" class="form-label">Website</label>
                <input type="url" class="form-control" id="companyWebsite" name="companyWebsite" value="<%= settings.companyWebsite || '' %>" placeholder="https://example.com">
              </div>
            </div>

            <div class="row">
              <div class="col-md-12 mb-3">
                <label for="logo" class="form-label">Company Logo</label>
                <% if (settings.logoPath) { %>
                <div class="mb-2">
                  <img src="/<%= settings.logoPath %>" alt="Company Logo" style="max-height: 100px; max-width: 200px; object-fit: contain;" class="img-thumbnail">
                  <p class="text-muted small mt-1">Current logo</p>
                </div>
                <% } %>
                <input type="file" class="form-control" id="logo" name="logo" accept="image/*">
                <small class="form-text text-muted">Upload a logo image (PNG, JPG, GIF). Max size: 5MB. Logo will appear on invoices.</small>
              </div>
            </div>
          </div>
        </div>

        <div class="card mb-4">
          <div class="card-header">
            <h5 class="mb-0">Invoice Settings</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="taxRate" class="form-label">Default Tax Rate (%)</label>
                <input type="number" class="form-control" id="taxRate" name="taxRate" value="<%= (settings.taxRate || 0.0625) * 100 %>" step="0.01" min="0" max="100">
                <small class="form-text text-muted">Enter as percentage (e.g., 6.25 for 6.25%)</small>
              </div>
            </div>

            <div class="row">
              <div class="col-md-12 mb-3">
                <label for="defaultPaymentTerms" class="form-label">Default Payment Terms</label>
                <input type="text" class="form-control" id="defaultPaymentTerms" name="defaultPaymentTerms" value="<%= settings.defaultPaymentTerms || '' %>">
                <small class="form-text text-muted">This will appear on invoices (e.g., "Payment due within 30 days")</small>
              </div>
            </div>

            <div class="row">
              <div class="col-md-12 mb-3">
                <label for="invoiceFooter" class="form-label">Invoice Footer Message</label>
                <textarea class="form-control" id="invoiceFooter" name="invoiceFooter" rows="2"><%= settings.invoiceFooter || '' %></textarea>
                <small class="form-text text-muted">Message to display at the bottom of invoices</small>
              </div>
            </div>
          </div>
        </div>

        <div class="d-flex gap-2">
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-save"></i> Save Settings
          </button>
          <a href="/" class="btn btn-secondary">Cancel</a>
        </div>
      </form>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>

